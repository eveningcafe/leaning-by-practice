# API GATEWAY - Multi Host Setup
# Host 1: Gateway + User Service
# Host 2: Order Service

upstream user_service {
    server user-service:5001;  # Same host (Host 1)
    # server 127.0.0.1:5001;   # Or localhost
}

upstream order_service {
    server HOST2_IP:5002;      # Change to Host 2 IP
}

server {
    listen 80;

    # Route /users/* to User Service
    location /users {
        proxy_pass http://user_service;
    }

    # Route /orders/* to Order Service
    location /orders {
        proxy_pass http://order_service;
    }

    location / {
        return 200 '{"gateway": "api-gateway", "routes": ["/users", "/orders"]}';
        add_header Content-Type application/json;
    }
}
